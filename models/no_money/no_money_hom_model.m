function [model] = get_model()
    model = model_info;
    model.f = @f;
    model.g = @g;
    model.a = @a;
end

function [out1,out2,out3,out4,out5] = f(s,x,snext,xnext,p)
    n = size(s,1);

    % f
      out1 = zeros(n,5);
      out1(:,1) = -p(1).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1).*exp(snext(:,2))./p(4) - p(3) + 1)./xnext(:,2) + 1./x(:,2);
      out1(:,2) = -p(1).*x(:,1)./xnext(:,2) + 1./x(:,2);
      out1(:,3) = -p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1)./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - x(:,1) + x(:,3);
      out1(:,4) = -0.5.*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1)./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + x(:,4);
      out1(:,5) = -0.5.*p(16).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + x(:,5) - (-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3));

if nargout >= 2

    % df/ds
      out2 = zeros(n,5,2);
      out2(:,1,1) = 0; % d eq_1 w.r.t. k
      out2(:,1,2) = 0; % d eq_1 w.r.t. z
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = 0; % d eq_2 w.r.t. z
      out2(:,3,1) = 0.5.*p(15).*p(16).*p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-p(14)./x(:,3) + x(:,3)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1)./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_3 w.r.t. k
      out2(:,3,2) = 0; % d eq_3 w.r.t. z
      out2(:,4,1) = 0.5.*p(2).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1)./(x(:,3).*s(:,1).*(-p(2) + 1).*(p(4) - 1)) + p(2).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*s(:,1).*(-p(2) + 1).*(p(4) - 1)) - 0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-p(14)./x(:,3) + x(:,3)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1)./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-p(14)./x(:,3) + x(:,3)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - 0.5.*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(p(2).*s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(s(:,1).*(p(4) - 1)) - x(:,3)).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1)./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(p(2).*s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(s(:,1).*(p(4) - 1)) - p(14)./x(:,3))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_4 w.r.t. k
      out2(:,4,2) = -0.5.*p(16).*p(4).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1).*exp(s(:,2))./(x(:,3).*(-p(2) + 1).*(p(4) - 1).^2) - p(4).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*exp(s(:,2))./(x(:,3).*(-p(2) + 1).*(p(4) - 1).^2); % d eq_4 w.r.t. z
      out2(:,5,1) = -0.5.*p(15).*p(16).*(-p(14)./x(:,3) + x(:,3)).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1) + 0.5.*p(15).*p(16).*(-p(14)./x(:,3) + x(:,3)).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1)./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)) - 0.5.*p(16).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(4).*s(:,1)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) - (-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(4).*s(:,1)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)); % d eq_5 w.r.t. k
      out2(:,5,2) = 0; % d eq_5 w.r.t. z

    % df/dx
      out3 = zeros(n,5,5);
      out3(:,1,1) = 0; % d eq_1 w.r.t. R
      out3(:,1,2) = -1./x(:,2).^2; % d eq_1 w.r.t. c
      out3(:,1,3) = 0; % d eq_1 w.r.t. RL
      out3(:,1,4) = 0; % d eq_1 w.r.t. nu_def
      out3(:,1,5) = 0; % d eq_1 w.r.t. d
      out3(:,2,1) = -p(1)./xnext(:,2); % d eq_2 w.r.t. R
      out3(:,2,2) = -1./x(:,2).^2; % d eq_2 w.r.t. c
      out3(:,2,3) = 0; % d eq_2 w.r.t. RL
      out3(:,2,4) = 0; % d eq_2 w.r.t. nu_def
      out3(:,2,5) = 0; % d eq_2 w.r.t. d
      out3(:,3,1) = 0.5.*p(15).*p(16).*p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(p(14).*x(:,5)./x(:,3) - x(:,5)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1)./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1)./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - 1; % d eq_3 w.r.t. R
      out3(:,3,2) = 0; % d eq_3 w.r.t. c
      out3(:,3,3) = 0.5.*p(15).*p(16).*p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5) + s(:,1))./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) + p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1)./(x(:,3).^2.*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) + 1; % d eq_3 w.r.t. RL
      out3(:,3,4) = p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1)./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) + p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-2./p(12)).*(x(:,1) - 1).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1)./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^2); % d eq_3 w.r.t. nu_def
      out3(:,3,5) = 0.5.*p(15).*p(16).*p(14).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3))./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_3 w.r.t. d
      out3(:,4,1) = -0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(p(14).*x(:,5)./x(:,3) - x(:,5)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1)./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(p(14).*x(:,5)./x(:,3) - x(:,5)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(p(14).*x(:,5)./x(:,3) - x(:,5))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_4 w.r.t. R
      out3(:,4,2) = 0; % d eq_4 w.r.t. c
      out3(:,4,3) = -0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5) + s(:,1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5) + s(:,1)).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 0.5.*p(16).*p(4).*s(:,1).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1)./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 0.5.*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1)./(x(:,3).^2.*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).^2.*(-p(2) + 1).*(p(4) - 1)); % d eq_4 w.r.t. RL
      out3(:,4,4) = -0.5.*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(-p(4) + 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1).^2) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1))).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1)./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 0.5.*p(16).*p(4).*s(:,1).^(-p(2)).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1)./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(-p(2) + 1).*(p(4) - 1).^2) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(-p(4) + 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1).^2) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1)))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 1 + p(4).*s(:,1).^(-p(2)).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(-p(2) + 1).*(p(4) - 1).^2); % d eq_4 w.r.t. nu_def
      out3(:,4,5) = -0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) + 0.5.*p(15).*p(16).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3)).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_4 w.r.t. d
      out3(:,5,1) = -0.5.*p(15).*p(16).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(p(14).*x(:,5)./x(:,3) - x(:,5)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1) + 0.5.*p(15).*p(16).*(p(14).*x(:,5)./x(:,3) - x(:,5)).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1)./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)).^2); % d eq_5 w.r.t. R
      out3(:,5,2) = 0; % d eq_5 w.r.t. c
      out3(:,5,3) = -0.5.*p(15).*p(16).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5) + s(:,1)) + 0.5.*p(15).*p(16).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5) + s(:,1))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)) - s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1)./(x(:,3).^2.*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3))) + (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(x(:,3).^2.*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)).^2); % d eq_5 w.r.t. RL
      out3(:,5,4) = -0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1).*(s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(4) - 1).*((1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-2./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^2))./p(4) + s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))))./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)))) - (-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(-(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)))).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)).^2 - (-0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1) + 1).*(s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(4) - 1).*((1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-2./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^2))./p(4) + s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))))./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13))))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)); % d eq_5 w.r.t. nu_def
      out3(:,5,5) = -0.5.*p(15).*p(16).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3)) + 0.5.*p(15).*p(16).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)) + 1; % d eq_5 w.r.t. d

    % df/dsnext
      out4 = zeros(n,5,2);
      out4(:,1,1) = -p(2).*p(1).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(2) - 1).*(p(4) - 1).*exp(snext(:,2))./(p(4).*xnext(:,2).*snext(:,1)); % d eq_1 w.r.t. k(1)
      out4(:,1,2) = -p(2).*p(1).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1).*exp(snext(:,2))./(p(4).*xnext(:,2)); % d eq_1 w.r.t. z(1)
      out4(:,2,1) = 0; % d eq_2 w.r.t. k(1)
      out4(:,2,2) = 0; % d eq_2 w.r.t. z(1)
      out4(:,3,1) = 0; % d eq_3 w.r.t. k(1)
      out4(:,3,2) = 0; % d eq_3 w.r.t. z(1)
      out4(:,4,1) = 0; % d eq_4 w.r.t. k(1)
      out4(:,4,2) = 0; % d eq_4 w.r.t. z(1)
      out4(:,5,1) = 0; % d eq_5 w.r.t. k(1)
      out4(:,5,2) = 0; % d eq_5 w.r.t. z(1)

    % df/dxnext
      out5 = zeros(n,5,5);
      out5(:,1,1) = 0; % d eq_1 w.r.t. R(1)
      out5(:,1,2) = p(1).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1).*exp(snext(:,2))./p(4) - p(3) + 1)./xnext(:,2).^2; % d eq_1 w.r.t. c(1)
      out5(:,1,3) = 0; % d eq_1 w.r.t. RL(1)
      out5(:,1,4) = -p(2).*p(1).*snext(:,1).^(p(2) - 1).*(1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*exp(snext(:,2))./(p(13).*p(4).*xnext(:,2).*(1 + p(12).*(-p(11) + xnext(:,4))./p(13))) - p(1).*(1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12)).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + xnext(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1).*exp(snext(:,2))./p(4) - p(3) + 1)./(p(13).*xnext(:,2).*(1 + p(12).*(-p(11) + xnext(:,4))./p(13))); % d eq_1 w.r.t. nu_def(1)
      out5(:,1,5) = 0; % d eq_1 w.r.t. d(1)
      out5(:,2,1) = 0; % d eq_2 w.r.t. R(1)
      out5(:,2,2) = p(1).*x(:,1)./xnext(:,2).^2; % d eq_2 w.r.t. c(1)
      out5(:,2,3) = 0; % d eq_2 w.r.t. RL(1)
      out5(:,2,4) = 0; % d eq_2 w.r.t. nu_def(1)
      out5(:,2,5) = 0; % d eq_2 w.r.t. d(1)
      out5(:,3,1) = 0; % d eq_3 w.r.t. R(1)
      out5(:,3,2) = 0; % d eq_3 w.r.t. c(1)
      out5(:,3,3) = 0; % d eq_3 w.r.t. RL(1)
      out5(:,3,4) = 0; % d eq_3 w.r.t. nu_def(1)
      out5(:,3,5) = 0; % d eq_3 w.r.t. d(1)
      out5(:,4,1) = 0; % d eq_4 w.r.t. R(1)
      out5(:,4,2) = 0; % d eq_4 w.r.t. c(1)
      out5(:,4,3) = 0; % d eq_4 w.r.t. RL(1)
      out5(:,4,4) = 0; % d eq_4 w.r.t. nu_def(1)
      out5(:,4,5) = 0; % d eq_4 w.r.t. d(1)
      out5(:,5,1) = 0; % d eq_5 w.r.t. R(1)
      out5(:,5,2) = 0; % d eq_5 w.r.t. c(1)
      out5(:,5,3) = 0; % d eq_5 w.r.t. RL(1)
      out5(:,5,4) = 0; % d eq_5 w.r.t. nu_def(1)
      out5(:,5,5) = 0; % d eq_5 w.r.t. d(1)

end

        
end

function [out1,out2,out3] = g(s,x,e,p)
    n = size(s,1);

    % g

      out1 = zeros(n,2);
      out1(:,1) = -x(:,2) - x(:,5) + s(:,1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(-p(3) + 1) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2));
      out1(:,2) = p(7).*s(:,2) + e(:,1);

if nargout >=2
    % dg/ds
          out2 = zeros(n,2,2);
      out2(:,1,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./s(:,1) + (1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(-p(3) + 1); % d eq_1 w.r.t. k
      out2(:,1,2) = s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2)); % d eq_1 w.r.t. z
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = p(7); % d eq_2 w.r.t. z
    % dg/dx
          out3 = zeros(n,2,5);
      out3(:,1,1) = 0; % d eq_1 w.r.t. R
      out3(:,1,2) = -1; % d eq_1 w.r.t. c
      out3(:,1,3) = 0; % d eq_1 w.r.t. RL
      out3(:,1,4) = s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(-p(3) + 1)./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_1 w.r.t. nu_def
      out3(:,1,5) = -1; % d eq_1 w.r.t. d
      out3(:,2,1) = 0; % d eq_2 w.r.t. R
      out3(:,2,2) = 0; % d eq_2 w.r.t. c
      out3(:,2,3) = 0; % d eq_2 w.r.t. RL
      out3(:,2,4) = 0; % d eq_2 w.r.t. nu_def
      out3(:,2,5) = 0; % d eq_2 w.r.t. d
end
        
end

function [out1,out2,out3] = a(s,x,p)
    n = size(s,1);

    % a

      out1 = zeros(n,20);
      out1(:,1) = 1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12));
      out1(:,2) = (1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4);
      out1(:,3) = s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(4) - 1).*exp(s(:,2))./p(4);
      out1(:,4) = s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2));
      out1(:,5) = s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1);
      out1(:,6) = p(2).*s(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1).*exp(s(:,2))./p(4);
      out1(:,7) = p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)));
      out1(:,8) = -s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4);
      out1(:,9) = (-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3));
      out1(:,10) = 1./x(:,2);
      out1(:,11) = -x(:,2) - x(:,5) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2));
      out1(:,12) = 1./x(:,2);
      out1(:,13) = (-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3);
      out1(:,14) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(x(:,5) + (-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3))./((-p(2) + 1).*(p(4) - 1));
      out1(:,15) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1));
      out1(:,16) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1));
      out1(:,17) = x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3));
      out1(:,18) = p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3);
      out1(:,19) = 0.5.*p(16).*(tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))) + 1);
      out1(:,20) = 0;

if nargout >=2
    % da/ds
          out2 = zeros(n,20,2);
      out2(:,1,1) = 0; % d eq_1 w.r.t. k
      out2(:,1,2) = 0; % d eq_1 w.r.t. z
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = 0; % d eq_2 w.r.t. z
      out2(:,3,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(4) - 1).*exp(s(:,2))./(p(4).*s(:,1)); % d eq_3 w.r.t. k
      out2(:,3,2) = s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(4) - 1).*exp(s(:,2))./p(4); % d eq_3 w.r.t. z
      out2(:,4,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./s(:,1); % d eq_4 w.r.t. k
      out2(:,4,2) = s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2)); % d eq_4 w.r.t. z
      out2(:,5,1) = p(2).*s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(s(:,1).*(p(4) - 1)); % d eq_5 w.r.t. k
      out2(:,5,2) = s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1); % d eq_5 w.r.t. z
      out2(:,6,1) = p(2).*s(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(2) - 1).*(p(4) - 1).*exp(s(:,2))./(p(4).*s(:,1)); % d eq_6 w.r.t. k
      out2(:,6,2) = p(2).*s(:,1).^(p(2) - 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1).*exp(s(:,2))./p(4); % d eq_6 w.r.t. z
      out2(:,7,1) = 0; % d eq_7 w.r.t. k
      out2(:,7,2) = 0; % d eq_7 w.r.t. z
      out2(:,8,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(4).*s(:,1)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)); % d eq_8 w.r.t. k
      out2(:,8,2) = 0; % d eq_8 w.r.t. z
      out2(:,9,1) = (p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(4).*s(:,1)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)); % d eq_9 w.r.t. k
      out2(:,9,2) = 0; % d eq_9 w.r.t. z
      out2(:,10,1) = 0; % d eq_10 w.r.t. k
      out2(:,10,2) = 0; % d eq_10 w.r.t. z
      out2(:,11,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./s(:,1); % d eq_11 w.r.t. k
      out2(:,11,2) = s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2)); % d eq_11 w.r.t. z
      out2(:,12,1) = 0; % d eq_12 w.r.t. k
      out2(:,12,2) = 0; % d eq_12 w.r.t. z
      out2(:,13,1) = 1./x(:,3); % d eq_13 w.r.t. k
      out2(:,13,2) = 0; % d eq_13 w.r.t. z
      out2(:,14,1) = -p(2).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(x(:,5) + (-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3))./(s(:,1).*(-p(2) + 1).*(p(4) - 1)) + p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_14 w.r.t. k
      out2(:,14,2) = 0; % d eq_14 w.r.t. z
      out2(:,15,1) = -p(2).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*s(:,1).*(-p(2) + 1).*(p(4) - 1)) + p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(p(2).*s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(s(:,1).*(p(4) - 1)) - p(14)./x(:,3))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_15 w.r.t. k
      out2(:,15,2) = p(4).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(x(:,3).*(-p(2) + 1).*(p(4) - 1).^2); % d eq_15 w.r.t. z
      out2(:,16,1) = -p(2).*p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).*s(:,1).*(-p(2) + 1).*(p(4) - 1)) + p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(p(2).*s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(s(:,1).*(p(4) - 1)) - x(:,3))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_16 w.r.t. k
      out2(:,16,2) = p(4).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(x(:,3).*(-p(2) + 1).*(p(4) - 1).^2); % d eq_16 w.r.t. z
      out2(:,17,1) = x(:,3); % d eq_17 w.r.t. k
      out2(:,17,2) = 0; % d eq_17 w.r.t. z
      out2(:,18,1) = p(14)./x(:,3); % d eq_18 w.r.t. k
      out2(:,18,2) = 0; % d eq_18 w.r.t. z
      out2(:,19,1) = 0.5.*p(15).*p(16).*(-p(14)./x(:,3) + x(:,3)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1); % d eq_19 w.r.t. k
      out2(:,19,2) = 0; % d eq_19 w.r.t. z
      out2(:,20,1) = 0; % d eq_20 w.r.t. k
      out2(:,20,2) = 0; % d eq_20 w.r.t. z
    % da/dx
          out3 = zeros(n,20,5);
      out3(:,1,1) = 0; % d eq_1 w.r.t. R
      out3(:,1,2) = 0; % d eq_1 w.r.t. c
      out3(:,1,3) = 0; % d eq_1 w.r.t. RL
      out3(:,1,4) = (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13))); % d eq_1 w.r.t. nu_def
      out3(:,1,5) = 0; % d eq_1 w.r.t. d
      out3(:,2,1) = 0; % d eq_2 w.r.t. R
      out3(:,2,2) = 0; % d eq_2 w.r.t. c
      out3(:,2,3) = 0; % d eq_2 w.r.t. RL
      out3(:,2,4) = (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1))./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_2 w.r.t. nu_def
      out3(:,2,5) = 0; % d eq_2 w.r.t. d
      out3(:,3,1) = 0; % d eq_3 w.r.t. R
      out3(:,3,2) = 0; % d eq_3 w.r.t. c
      out3(:,3,3) = 0; % d eq_3 w.r.t. RL
      out3(:,3,4) = s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*exp(s(:,2))./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_3 w.r.t. nu_def
      out3(:,3,5) = 0; % d eq_3 w.r.t. d
      out3(:,4,1) = 0; % d eq_4 w.r.t. R
      out3(:,4,2) = 0; % d eq_4 w.r.t. c
      out3(:,4,3) = 0; % d eq_4 w.r.t. RL
      out3(:,4,4) = s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_4 w.r.t. nu_def
      out3(:,4,5) = 0; % d eq_4 w.r.t. d
      out3(:,5,1) = 0; % d eq_5 w.r.t. R
      out3(:,5,2) = 0; % d eq_5 w.r.t. c
      out3(:,5,3) = 0; % d eq_5 w.r.t. RL
      out3(:,5,4) = s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(-p(4) + 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1).^2) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1)); % d eq_5 w.r.t. nu_def
      out3(:,5,5) = 0; % d eq_5 w.r.t. d
      out3(:,6,1) = 0; % d eq_6 w.r.t. R
      out3(:,6,2) = 0; % d eq_6 w.r.t. c
      out3(:,6,3) = 0; % d eq_6 w.r.t. RL
      out3(:,6,4) = p(2).*s(:,1).^(p(2) - 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*exp(s(:,2))./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_6 w.r.t. nu_def
      out3(:,6,5) = 0; % d eq_6 w.r.t. d
      out3(:,7,1) = 0; % d eq_7 w.r.t. R
      out3(:,7,2) = 0; % d eq_7 w.r.t. c
      out3(:,7,3) = 0; % d eq_7 w.r.t. RL
      out3(:,7,4) = (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-2./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^2); % d eq_7 w.r.t. nu_def
      out3(:,7,5) = 0; % d eq_7 w.r.t. d
      out3(:,8,1) = 0; % d eq_8 w.r.t. R
      out3(:,8,2) = 0; % d eq_8 w.r.t. c
      out3(:,8,3) = 0; % d eq_8 w.r.t. RL
      out3(:,8,4) = s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(4) - 1).*((1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-2./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^2))./p(4) + s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))))./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13))); % d eq_8 w.r.t. nu_def
      out3(:,8,5) = 0; % d eq_8 w.r.t. d
      out3(:,9,1) = (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(x(:,3).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)).^2); % d eq_9 w.r.t. R
      out3(:,9,2) = 0; % d eq_9 w.r.t. c
      out3(:,9,3) = s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(x(:,3).^2.*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3))) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(x(:,3).^2.*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)).^2); % d eq_9 w.r.t. RL
      out3(:,9,4) = (-(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)))).*(-s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./p(4))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)).^2 + (s(:,1).^p(2).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(4) - 1).*((1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))) - x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-2./p(12))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^2))./p(4) + s(:,1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))).*(p(4) - 1)./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13))) + s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(-p(2) + 1).*(p(13) + x(:,4).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))))./(p(13).*p(4).*(1 + p(12).*(-p(11) + x(:,4))./p(13))))./(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)) - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(x(:,1) - 1)./x(:,3)); % d eq_9 w.r.t. nu_def
      out3(:,9,5) = 0; % d eq_9 w.r.t. d
      out3(:,10,1) = 0; % d eq_10 w.r.t. R
      out3(:,10,2) = -1./x(:,2).^2; % d eq_10 w.r.t. c
      out3(:,10,3) = 0; % d eq_10 w.r.t. RL
      out3(:,10,4) = 0; % d eq_10 w.r.t. nu_def
      out3(:,10,5) = 0; % d eq_10 w.r.t. d
      out3(:,11,1) = 0; % d eq_11 w.r.t. R
      out3(:,11,2) = -1; % d eq_11 w.r.t. c
      out3(:,11,3) = 0; % d eq_11 w.r.t. RL
      out3(:,11,4) = s(:,1).^p(2).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)))); % d eq_11 w.r.t. nu_def
      out3(:,11,5) = -1; % d eq_11 w.r.t. d
      out3(:,12,1) = 0; % d eq_12 w.r.t. R
      out3(:,12,2) = -1./x(:,2).^2; % d eq_12 w.r.t. c
      out3(:,12,3) = 0; % d eq_12 w.r.t. RL
      out3(:,12,4) = 0; % d eq_12 w.r.t. nu_def
      out3(:,12,5) = 0; % d eq_12 w.r.t. d
      out3(:,13,1) = -x(:,5)./x(:,3); % d eq_13 w.r.t. R
      out3(:,13,2) = 0; % d eq_13 w.r.t. c
      out3(:,13,3) = -(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2; % d eq_13 w.r.t. RL
      out3(:,13,4) = 0; % d eq_13 w.r.t. nu_def
      out3(:,13,5) = (-x(:,1) + 1)./x(:,3); % d eq_13 w.r.t. d
      out3(:,14,1) = -p(4).*x(:,5).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_14 w.r.t. R
      out3(:,14,2) = 0; % d eq_14 w.r.t. c
      out3(:,14,3) = -p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./(x(:,3).^2.*(-p(2) + 1).*(p(4) - 1)); % d eq_14 w.r.t. RL
      out3(:,14,4) = -p(4).*s(:,1).^(-p(2)).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(x(:,5) + (-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(-p(2) + 1).*(p(4) - 1).^2); % d eq_14 w.r.t. nu_def
      out3(:,14,5) = p(4).*s(:,1).^(-p(2)).*(1 + (-x(:,1) + 1)./x(:,3)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1))./((-p(2) + 1).*(p(4) - 1)); % d eq_14 w.r.t. d
      out3(:,15,1) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(p(14).*x(:,5)./x(:,3) - x(:,5))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_15 w.r.t. R
      out3(:,15,2) = 0; % d eq_15 w.r.t. c
      out3(:,15,3) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).^2.*(-p(2) + 1).*(p(4) - 1)); % d eq_15 w.r.t. RL
      out3(:,15,4) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(-p(4) + 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1).^2) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1)))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,5).*(-x(:,1) + x(:,3)) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(-p(2) + 1).*(p(4) - 1).^2); % d eq_15 w.r.t. nu_def
      out3(:,15,5) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)); % d eq_15 w.r.t. d
      out3(:,16,1) = 0; % d eq_16 w.r.t. R
      out3(:,16,2) = 0; % d eq_16 w.r.t. c
      out3(:,16,3) = -p(4).*s(:,1).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(x(:,3).^2.*(-p(2) + 1).*(p(4) - 1)); % d eq_16 w.r.t. RL
      out3(:,16,4) = p(4).*s(:,1).^(-p(2)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(-p(4) + 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1).^2) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(13).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(p(4) - 1)))./(x(:,3).*(-p(2) + 1).*(p(4) - 1)) - p(4).*s(:,1).^(-p(2)).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(-1./(p(4) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(4)./(p(4) - 1)).^(-p(4)).*((1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(1./(p(4) - 1)).*(p(4) - 1)./p(4)).^(-p(4) + 1).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).^(p(2) + p(4)./(p(4) - 1) - 1).*exp(s(:,2))./(p(4) - 1))./(p(13).*x(:,3).*(1 + p(12).*(-p(11) + x(:,4))./p(13)).*(1 - (1 + p(12).*(-p(11) + x(:,4))./p(13)).^(-1./p(12))).*(-p(2) + 1).*(p(4) - 1).^2); % d eq_16 w.r.t. nu_def
      out3(:,16,5) = 0; % d eq_16 w.r.t. d
      out3(:,17,1) = -x(:,5); % d eq_17 w.r.t. R
      out3(:,17,2) = 0; % d eq_17 w.r.t. c
      out3(:,17,3) = x(:,5) + s(:,1); % d eq_17 w.r.t. RL
      out3(:,17,4) = 0; % d eq_17 w.r.t. nu_def
      out3(:,17,5) = -x(:,1) + x(:,3); % d eq_17 w.r.t. d
      out3(:,18,1) = -p(14).*x(:,5)./x(:,3); % d eq_18 w.r.t. R
      out3(:,18,2) = 0; % d eq_18 w.r.t. c
      out3(:,18,3) = -p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2; % d eq_18 w.r.t. RL
      out3(:,18,4) = 0; % d eq_18 w.r.t. nu_def
      out3(:,18,5) = p(14).*(-x(:,1) + 1)./x(:,3); % d eq_18 w.r.t. d
      out3(:,19,1) = 0.5.*p(15).*p(16).*(p(14).*x(:,5)./x(:,3) - x(:,5)).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1); % d eq_19 w.r.t. R
      out3(:,19,2) = 0; % d eq_19 w.r.t. c
      out3(:,19,3) = 0.5.*p(15).*p(16).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3).^2 + x(:,5) + s(:,1)); % d eq_19 w.r.t. RL
      out3(:,19,4) = 0; % d eq_19 w.r.t. nu_def
      out3(:,19,5) = 0.5.*p(15).*p(16).*(-tanh(p(15).*(-p(14).*(-x(:,5).*(x(:,1) - 1) + s(:,1))./x(:,3) + x(:,3).*s(:,1) + x(:,5).*(-x(:,1) + x(:,3)))).^2 + 1).*(-p(14).*(-x(:,1) + 1)./x(:,3) - x(:,1) + x(:,3)); % d eq_19 w.r.t. d
      out3(:,20,1) = 0; % d eq_20 w.r.t. R
      out3(:,20,2) = 0; % d eq_20 w.r.t. c
      out3(:,20,3) = 0; % d eq_20 w.r.t. RL
      out3(:,20,4) = 0; % d eq_20 w.r.t. nu_def
      out3(:,20,5) = 0; % d eq_20 w.r.t. d
end
                    
end

function [out1] = model_info() % informations about the model

    mod = struct;
    mod.states = { 'k','z' };
    mod.controls = { 'R','c','RL','nu_def','d' };
    mod.auxiliaries = { 'Phi','mu','w','y','pro','rk','Enu_def','d_per','d_imp','uc','I','lamb','lhat','nu_rat','nu_strat','nu_star','pro_B','pro_def','perfect','rat' };
    mod.parameters = { 'beta','alpha','delta','theta','gamma','varphi','rho','sigma_z','sigma_u','spreadq','me','xi','sigma','vartheta','big','hom' };
    mod.shocks = { 'e_z' };
    mod.s_ss = [27.3325 ; 0.0];
    mod.x_ss = [1.00755667506 ; 2.66620400625 ; 1.00755667506 ; -15.2955 ; -0.1628];
    mod.params = [  9.92500000e-01   3.60000000e-01   1.90000000e-02   6.00000000e+00   5.00000000e-01   0.00000000e+00   9.50000000e-01   7.00000000e-03   3.60000000e-03   9.50000000e-03  -3.00000000e+01   9.00000000e-01   2.00000000e-01   9.00000000e-01   5.00000000e+00   1.00000000e+00];
    out1 = mod;

end
