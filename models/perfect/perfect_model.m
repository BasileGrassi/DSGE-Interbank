function [model] = get_model()
    model = model_info;
    model.f = @f;
    model.g = @g;
    model.a = @a;
end

function [out1,out2,out3,out4,out5] = f(s,x,snext,xnext,p)
    n = size(s,1);

    % f
      out1 = zeros(n,4);
      out1(:,1) = -p(1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1)./(xnext(:,1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))) + 1./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)));
      out1(:,2) = -p(1)./((xnext(:,2) + 1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))) + 1./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)));
      out1(:,3) = -x(:,1) + x(:,3);
      out1(:,4) = -p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)) + x(:,4);

if nargout >= 2

    % df/ds
      out2 = zeros(n,4,5);
      out2(:,1,1) = (p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. k
      out2(:,1,2) = 0; % d eq_1 w.r.t. mm
      out2(:,1,3) = -1./(x(:,1).*(x(:,2) + 1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. mL
      out2(:,1,4) = 0; % d eq_1 w.r.t. z
      out2(:,1,5) = -1./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. u
      out2(:,2,1) = (p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. k
      out2(:,2,2) = 0; % d eq_2 w.r.t. mm
      out2(:,2,3) = -1./(x(:,1).*(x(:,2) + 1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. mL
      out2(:,2,4) = 0; % d eq_2 w.r.t. z
      out2(:,2,5) = -1./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. u
      out2(:,3,1) = 0; % d eq_3 w.r.t. k
      out2(:,3,2) = 0; % d eq_3 w.r.t. mm
      out2(:,3,3) = 0; % d eq_3 w.r.t. mL
      out2(:,3,4) = 0; % d eq_3 w.r.t. z
      out2(:,3,5) = 0; % d eq_3 w.r.t. u
      out2(:,4,1) = p(2).*p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(x(:,3).*s(:,1).*(-p(2) + 1).*(p(5) - 1)) - p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(2).*s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(s(:,1).*(p(5) - 1)) - x(:,3))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)); % d eq_4 w.r.t. k
      out2(:,4,2) = 0; % d eq_4 w.r.t. mm
      out2(:,4,3) = 0; % d eq_4 w.r.t. mL
      out2(:,4,4) = -p(5).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(x(:,3).*(-p(2) + 1).*(p(5) - 1).^2); % d eq_4 w.r.t. z
      out2(:,4,5) = 0; % d eq_4 w.r.t. u

    % df/dx
      out3 = zeros(n,4,4);
      out3(:,1,1) = -1./(x(:,1).^2.*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))); % d eq_1 w.r.t. R
      out3(:,1,2) = s(:,3)./(x(:,1).*(x(:,2) + 1).^2.*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. PI
      out3(:,1,3) = 0; % d eq_1 w.r.t. RL
      out3(:,1,4) = (s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. nu_def
      out3(:,2,1) = -1./(x(:,1).^2.*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))); % d eq_2 w.r.t. R
      out3(:,2,2) = s(:,3)./(x(:,1).*(x(:,2) + 1).^2.*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. PI
      out3(:,2,3) = 0; % d eq_2 w.r.t. RL
      out3(:,2,4) = (s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. nu_def
      out3(:,3,1) = -1; % d eq_3 w.r.t. R
      out3(:,3,2) = 0; % d eq_3 w.r.t. PI
      out3(:,3,3) = 1; % d eq_3 w.r.t. RL
      out3(:,3,4) = 0; % d eq_3 w.r.t. nu_def
      out3(:,4,1) = 0; % d eq_4 w.r.t. R
      out3(:,4,2) = 0; % d eq_4 w.r.t. PI
      out3(:,4,3) = p(5).*s(:,1).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)) + p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(x(:,3).^2.*(-p(2) + 1).*(p(5) - 1)); % d eq_4 w.r.t. RL
      out3(:,4,4) = -p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(-p(5) + 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1).^2) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1)))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)) + 1 + p(5).*s(:,1).^(-p(2)).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(p(14).*x(:,3).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(-p(2) + 1).*(p(5) - 1).^2); % d eq_4 w.r.t. nu_def

    % df/dsnext
      out4 = zeros(n,4,5);
      out4(:,1,1) = -p(2).*p(1).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(2) - 1).*(p(5) - 1).*exp(snext(:,4))./(p(5).*xnext(:,1).*snext(:,1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))) - p(1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*snext(:,1)) - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1)./(xnext(:,1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. k(1)
      out4(:,1,2) = 0; % d eq_1 w.r.t. mm(1)
      out4(:,1,3) = p(1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1)./(xnext(:,1).*(xnext(:,2) + 1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. mL(1)
      out4(:,1,4) = -p(2).*p(1).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./(p(5).*xnext(:,1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))); % d eq_1 w.r.t. z(1)
      out4(:,1,5) = p(1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1)./(xnext(:,1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. u(1)
      out4(:,2,1) = -p(1).*(p(2).*snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*snext(:,1)) - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))./((xnext(:,2) + 1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. k(1)
      out4(:,2,2) = 0; % d eq_2 w.r.t. mm(1)
      out4(:,2,3) = p(1)./((xnext(:,2) + 1).^2.*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. mL(1)
      out4(:,2,4) = 0; % d eq_2 w.r.t. z(1)
      out4(:,2,5) = p(1)./((xnext(:,2) + 1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. u(1)
      out4(:,3,1) = 0; % d eq_3 w.r.t. k(1)
      out4(:,3,2) = 0; % d eq_3 w.r.t. mm(1)
      out4(:,3,3) = 0; % d eq_3 w.r.t. mL(1)
      out4(:,3,4) = 0; % d eq_3 w.r.t. z(1)
      out4(:,3,5) = 0; % d eq_3 w.r.t. u(1)
      out4(:,4,1) = 0; % d eq_4 w.r.t. k(1)
      out4(:,4,2) = 0; % d eq_4 w.r.t. mm(1)
      out4(:,4,3) = 0; % d eq_4 w.r.t. mL(1)
      out4(:,4,4) = 0; % d eq_4 w.r.t. z(1)
      out4(:,4,5) = 0; % d eq_4 w.r.t. u(1)

    % df/dxnext
      out5 = zeros(n,4,4);
      out5(:,1,1) = p(1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1)./(xnext(:,1).^2.*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))); % d eq_1 w.r.t. R(1)
      out5(:,1,2) = -p(1).*snext(:,3).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1)./(xnext(:,1).*(xnext(:,2) + 1).^2.*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_1 w.r.t. PI(1)
      out5(:,1,3) = 0; % d eq_1 w.r.t. RL(1)
      out5(:,1,4) = -p(2).*p(1).*snext(:,1).^(p(2) - 1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*exp(snext(:,4))./(p(14).*p(5).*xnext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))) - p(1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1).*(snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))) - xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))) - xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14))) + snext(:,1).^p(2).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14))) + snext(:,1).^p(2).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14))))./(xnext(:,1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2) - p(1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)).*(p(2).*snext(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(snext(:,4))./p(5) - p(3) + 1)./(p(14).*xnext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))); % d eq_1 w.r.t. nu_def(1)
      out5(:,2,1) = 0; % d eq_2 w.r.t. R(1)
      out5(:,2,2) = -p(1).*snext(:,3)./((xnext(:,2) + 1).^3.*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2) + p(1)./((xnext(:,2) + 1).^2.*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))); % d eq_2 w.r.t. PI(1)
      out5(:,2,3) = 0; % d eq_2 w.r.t. RL(1)
      out5(:,2,4) = -p(1).*(snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))) - xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))) - xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14))) + snext(:,1).^p(2).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14))) + snext(:,1).^p(2).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14))))./((xnext(:,2) + 1).*(p(4) + snext(:,1).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)) + snext(:,3)./(xnext(:,2) + 1) + snext(:,5) - snext(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + xnext(:,4).*(1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + xnext(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_2 w.r.t. nu_def(1)
      out5(:,3,1) = 0; % d eq_3 w.r.t. R(1)
      out5(:,3,2) = 0; % d eq_3 w.r.t. PI(1)
      out5(:,3,3) = 0; % d eq_3 w.r.t. RL(1)
      out5(:,3,4) = 0; % d eq_3 w.r.t. nu_def(1)
      out5(:,4,1) = 0; % d eq_4 w.r.t. R(1)
      out5(:,4,2) = 0; % d eq_4 w.r.t. PI(1)
      out5(:,4,3) = 0; % d eq_4 w.r.t. RL(1)
      out5(:,4,4) = 0; % d eq_4 w.r.t. nu_def(1)

end

        
end

function [out1,out2,out3] = g(s,x,e,p)
    n = size(s,1);

    % g

      out1 = zeros(n,5);
      out1(:,1) = -p(4) + s(:,1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(-p(3) + 1) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4)) - s(:,3)./(x(:,2) + 1) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5);
      out1(:,2) = s(:,2).*(p(6).*s(:,5) + p(7).*s(:,4) + p(4) + e(:,2) + 1)./(x(:,2) + 1);
      out1(:,3) = s(:,2)./(x(:,2) + 1);
      out1(:,4) = p(8).*s(:,4) + e(:,1);
      out1(:,5) = p(6).*s(:,5) + p(7).*s(:,4) + e(:,2);

if nargout >=2
    % dg/ds
          out2 = zeros(n,5,5);
      out2(:,1,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./s(:,1) + p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) + (1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(-p(3) + 1) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)); % d eq_1 w.r.t. k
      out2(:,1,2) = 0; % d eq_1 w.r.t. mm
      out2(:,1,3) = -1./(x(:,2) + 1); % d eq_1 w.r.t. mL
      out2(:,1,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4)); % d eq_1 w.r.t. z
      out2(:,1,5) = -1; % d eq_1 w.r.t. u
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = (p(6).*s(:,5) + p(7).*s(:,4) + p(4) + e(:,2) + 1)./(x(:,2) + 1); % d eq_2 w.r.t. mm
      out2(:,2,3) = 0; % d eq_2 w.r.t. mL
      out2(:,2,4) = p(7).*s(:,2)./(x(:,2) + 1); % d eq_2 w.r.t. z
      out2(:,2,5) = p(6).*s(:,2)./(x(:,2) + 1); % d eq_2 w.r.t. u
      out2(:,3,1) = 0; % d eq_3 w.r.t. k
      out2(:,3,2) = 1./(x(:,2) + 1); % d eq_3 w.r.t. mm
      out2(:,3,3) = 0; % d eq_3 w.r.t. mL
      out2(:,3,4) = 0; % d eq_3 w.r.t. z
      out2(:,3,5) = 0; % d eq_3 w.r.t. u
      out2(:,4,1) = 0; % d eq_4 w.r.t. k
      out2(:,4,2) = 0; % d eq_4 w.r.t. mm
      out2(:,4,3) = 0; % d eq_4 w.r.t. mL
      out2(:,4,4) = p(8); % d eq_4 w.r.t. z
      out2(:,4,5) = 0; % d eq_4 w.r.t. u
      out2(:,5,1) = 0; % d eq_5 w.r.t. k
      out2(:,5,2) = 0; % d eq_5 w.r.t. mm
      out2(:,5,3) = 0; % d eq_5 w.r.t. mL
      out2(:,5,4) = p(7); % d eq_5 w.r.t. z
      out2(:,5,5) = p(6); % d eq_5 w.r.t. u
    % dg/dx
          out3 = zeros(n,5,4);
      out3(:,1,1) = 0; % d eq_1 w.r.t. R
      out3(:,1,2) = s(:,3)./(x(:,2) + 1).^2; % d eq_1 w.r.t. PI
      out3(:,1,3) = 0; % d eq_1 w.r.t. RL
      out3(:,1,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(-p(3) + 1)./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))); % d eq_1 w.r.t. nu_def
      out3(:,2,1) = 0; % d eq_2 w.r.t. R
      out3(:,2,2) = -s(:,2).*(p(6).*s(:,5) + p(7).*s(:,4) + p(4) + e(:,2) + 1)./(x(:,2) + 1).^2; % d eq_2 w.r.t. PI
      out3(:,2,3) = 0; % d eq_2 w.r.t. RL
      out3(:,2,4) = 0; % d eq_2 w.r.t. nu_def
      out3(:,3,1) = 0; % d eq_3 w.r.t. R
      out3(:,3,2) = -s(:,2)./(x(:,2) + 1).^2; % d eq_3 w.r.t. PI
      out3(:,3,3) = 0; % d eq_3 w.r.t. RL
      out3(:,3,4) = 0; % d eq_3 w.r.t. nu_def
      out3(:,4,1) = 0; % d eq_4 w.r.t. R
      out3(:,4,2) = 0; % d eq_4 w.r.t. PI
      out3(:,4,3) = 0; % d eq_4 w.r.t. RL
      out3(:,4,4) = 0; % d eq_4 w.r.t. nu_def
      out3(:,5,1) = 0; % d eq_5 w.r.t. R
      out3(:,5,2) = 0; % d eq_5 w.r.t. PI
      out3(:,5,3) = 0; % d eq_5 w.r.t. RL
      out3(:,5,4) = 0; % d eq_5 w.r.t. nu_def
end
        
end

function [out1,out2,out3] = a(s,x,p)
    n = size(s,1);

    % a

      out1 = zeros(n,24);
      out1(:,1) = 1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13));
      out1(:,2) = (1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5);
      out1(:,3) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*exp(s(:,4))./p(5);
      out1(:,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4));
      out1(:,5) = s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1);
      out1(:,6) = p(2).*s(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(s(:,4))./p(5);
      out1(:,7) = p(4) + s(:,5);
      out1(:,8) = p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)));
      out1(:,9) = -p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5);
      out1(:,10) = (-(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(4) + s(:,5)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(p(4) + s(:,1) + s(:,5))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3));
      out1(:,11) = -p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5);
      out1(:,12) = s(:,2)./(x(:,2) + 1);
      out1(:,13) = p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5);
      out1(:,14) = 1./(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5));
      out1(:,15) = -p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4)) - s(:,3)./(x(:,2) + 1) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5);
      out1(:,16) = 1./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)));
      out1(:,17) = (p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3);
      out1(:,18) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + (p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./((-p(2) + 1).*(p(5) - 1));
      out1(:,19) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-p(15).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3) + x(:,3).*(p(4) + s(:,5)) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1) + (-x(:,1) + x(:,3)).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./(x(:,3).*(-p(2) + 1).*(p(5) - 1));
      out1(:,20) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(x(:,3).*(-p(2) + 1).*(p(5) - 1));
      out1(:,21) = x(:,3).*s(:,1) + x(:,3).*(p(4) + s(:,5)) + (-x(:,1) + x(:,3)).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5));
      out1(:,22) = p(15).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3);
      out1(:,23) = 0;
      out1(:,24) = 0;

if nargout >=2
    % da/ds
          out2 = zeros(n,24,5);
      out2(:,1,1) = 0; % d eq_1 w.r.t. k
      out2(:,1,2) = 0; % d eq_1 w.r.t. mm
      out2(:,1,3) = 0; % d eq_1 w.r.t. mL
      out2(:,1,4) = 0; % d eq_1 w.r.t. z
      out2(:,1,5) = 0; % d eq_1 w.r.t. u
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = 0; % d eq_2 w.r.t. mm
      out2(:,2,3) = 0; % d eq_2 w.r.t. mL
      out2(:,2,4) = 0; % d eq_2 w.r.t. z
      out2(:,2,5) = 0; % d eq_2 w.r.t. u
      out2(:,3,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*exp(s(:,4))./(p(5).*s(:,1)); % d eq_3 w.r.t. k
      out2(:,3,2) = 0; % d eq_3 w.r.t. mm
      out2(:,3,3) = 0; % d eq_3 w.r.t. mL
      out2(:,3,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*exp(s(:,4))./p(5); % d eq_3 w.r.t. z
      out2(:,3,5) = 0; % d eq_3 w.r.t. u
      out2(:,4,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./s(:,1); % d eq_4 w.r.t. k
      out2(:,4,2) = 0; % d eq_4 w.r.t. mm
      out2(:,4,3) = 0; % d eq_4 w.r.t. mL
      out2(:,4,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4)); % d eq_4 w.r.t. z
      out2(:,4,5) = 0; % d eq_4 w.r.t. u
      out2(:,5,1) = p(2).*s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(s(:,1).*(p(5) - 1)); % d eq_5 w.r.t. k
      out2(:,5,2) = 0; % d eq_5 w.r.t. mm
      out2(:,5,3) = 0; % d eq_5 w.r.t. mL
      out2(:,5,4) = s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1); % d eq_5 w.r.t. z
      out2(:,5,5) = 0; % d eq_5 w.r.t. u
      out2(:,6,1) = p(2).*s(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(2) - 1).*(p(5) - 1).*exp(s(:,4))./(p(5).*s(:,1)); % d eq_6 w.r.t. k
      out2(:,6,2) = 0; % d eq_6 w.r.t. mm
      out2(:,6,3) = 0; % d eq_6 w.r.t. mL
      out2(:,6,4) = p(2).*s(:,1).^(p(2) - 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1).*exp(s(:,4))./p(5); % d eq_6 w.r.t. z
      out2(:,6,5) = 0; % d eq_6 w.r.t. u
      out2(:,7,1) = 0; % d eq_7 w.r.t. k
      out2(:,7,2) = 0; % d eq_7 w.r.t. mm
      out2(:,7,3) = 0; % d eq_7 w.r.t. mL
      out2(:,7,4) = 0; % d eq_7 w.r.t. z
      out2(:,7,5) = 1; % d eq_7 w.r.t. u
      out2(:,8,1) = 0; % d eq_8 w.r.t. k
      out2(:,8,2) = 0; % d eq_8 w.r.t. mm
      out2(:,8,3) = 0; % d eq_8 w.r.t. mL
      out2(:,8,4) = 0; % d eq_8 w.r.t. z
      out2(:,8,5) = 0; % d eq_8 w.r.t. u
      out2(:,9,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)); % d eq_9 w.r.t. k
      out2(:,9,2) = 0; % d eq_9 w.r.t. mm
      out2(:,9,3) = 0; % d eq_9 w.r.t. mL
      out2(:,9,4) = 0; % d eq_9 w.r.t. z
      out2(:,9,5) = -1; % d eq_9 w.r.t. u
      out2(:,10,1) = (p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./x(:,3))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3)); % d eq_10 w.r.t. k
      out2(:,10,2) = 0; % d eq_10 w.r.t. mm
      out2(:,10,3) = 0; % d eq_10 w.r.t. mL
      out2(:,10,4) = 0; % d eq_10 w.r.t. z
      out2(:,10,5) = (-1 + (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./x(:,3))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3)); % d eq_10 w.r.t. u
      out2(:,11,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)); % d eq_11 w.r.t. k
      out2(:,11,2) = 0; % d eq_11 w.r.t. mm
      out2(:,11,3) = 0; % d eq_11 w.r.t. mL
      out2(:,11,4) = 0; % d eq_11 w.r.t. z
      out2(:,11,5) = -1; % d eq_11 w.r.t. u
      out2(:,12,1) = 0; % d eq_12 w.r.t. k
      out2(:,12,2) = 1./(x(:,2) + 1); % d eq_12 w.r.t. mm
      out2(:,12,3) = 0; % d eq_12 w.r.t. mL
      out2(:,12,4) = 0; % d eq_12 w.r.t. z
      out2(:,12,5) = 0; % d eq_12 w.r.t. u
      out2(:,13,1) = -p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) + (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)); % d eq_13 w.r.t. k
      out2(:,13,2) = 0; % d eq_13 w.r.t. mm
      out2(:,13,3) = 1./(x(:,2) + 1); % d eq_13 w.r.t. mL
      out2(:,13,4) = 0; % d eq_13 w.r.t. z
      out2(:,13,5) = 1; % d eq_13 w.r.t. u
      out2(:,14,1) = (p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))./(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2; % d eq_14 w.r.t. k
      out2(:,14,2) = 0; % d eq_14 w.r.t. mm
      out2(:,14,3) = -1./((x(:,2) + 1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_14 w.r.t. mL
      out2(:,14,4) = 0; % d eq_14 w.r.t. z
      out2(:,14,5) = -1./(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2; % d eq_14 w.r.t. u
      out2(:,15,1) = p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./s(:,1) + p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)); % d eq_15 w.r.t. k
      out2(:,15,2) = 0; % d eq_15 w.r.t. mm
      out2(:,15,3) = -1./(x(:,2) + 1); % d eq_15 w.r.t. mL
      out2(:,15,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4)); % d eq_15 w.r.t. z
      out2(:,15,5) = -1; % d eq_15 w.r.t. u
      out2(:,16,1) = (p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_16 w.r.t. k
      out2(:,16,2) = 0; % d eq_16 w.r.t. mm
      out2(:,16,3) = -1./(x(:,1).*(x(:,2) + 1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_16 w.r.t. mL
      out2(:,16,4) = 0; % d eq_16 w.r.t. z
      out2(:,16,5) = -1./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_16 w.r.t. u
      out2(:,17,1) = (-(x(:,1) - 1).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) + 1)./x(:,3); % d eq_17 w.r.t. k
      out2(:,17,2) = 0; % d eq_17 w.r.t. mm
      out2(:,17,3) = 0; % d eq_17 w.r.t. mL
      out2(:,17,4) = 0; % d eq_17 w.r.t. z
      out2(:,17,5) = x(:,1)./x(:,3); % d eq_17 w.r.t. u
      out2(:,18,1) = -p(2).*p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + (p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(s(:,1).*(-p(2) + 1).*(p(5) - 1)) + p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + (-(x(:,1) - 1).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) + 1)./x(:,3))./((-p(2) + 1).*(p(5) - 1)); % d eq_18 w.r.t. k
      out2(:,18,2) = 0; % d eq_18 w.r.t. mm
      out2(:,18,3) = 0; % d eq_18 w.r.t. mL
      out2(:,18,4) = 0; % d eq_18 w.r.t. z
      out2(:,18,5) = p(5).*x(:,1).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)); % d eq_18 w.r.t. u
      out2(:,19,1) = -p(2).*p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-p(15).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3) + x(:,3).*(p(4) + s(:,5)) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1) + (-x(:,1) + x(:,3)).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./(x(:,3).*s(:,1).*(-p(2) + 1).*(p(5) - 1)) + p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(2).*s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(s(:,1).*(p(5) - 1)) - p(15).*(-(x(:,1) - 1).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) + 1)./x(:,3) + (-x(:,1) + x(:,3)).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)); % d eq_19 w.r.t. k
      out2(:,19,2) = 0; % d eq_19 w.r.t. mm
      out2(:,19,3) = 0; % d eq_19 w.r.t. mL
      out2(:,19,4) = p(5).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(x(:,3).*(-p(2) + 1).*(p(5) - 1).^2); % d eq_19 w.r.t. z
      out2(:,19,5) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-p(15).*x(:,1)./x(:,3) + x(:,1))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)); % d eq_19 w.r.t. u
      out2(:,20,1) = -p(2).*p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(x(:,3).*s(:,1).*(-p(2) + 1).*(p(5) - 1)) + p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(2).*s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(s(:,1).*(p(5) - 1)) - x(:,3))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)); % d eq_20 w.r.t. k
      out2(:,20,2) = 0; % d eq_20 w.r.t. mm
      out2(:,20,3) = 0; % d eq_20 w.r.t. mL
      out2(:,20,4) = p(5).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(x(:,3).*(-p(2) + 1).*(p(5) - 1).^2); % d eq_20 w.r.t. z
      out2(:,20,5) = 0; % d eq_20 w.r.t. u
      out2(:,21,1) = x(:,3) + (-x(:,1) + x(:,3)).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))); % d eq_21 w.r.t. k
      out2(:,21,2) = 0; % d eq_21 w.r.t. mm
      out2(:,21,3) = 0; % d eq_21 w.r.t. mL
      out2(:,21,4) = 0; % d eq_21 w.r.t. z
      out2(:,21,5) = x(:,1); % d eq_21 w.r.t. u
      out2(:,22,1) = p(15).*(-(x(:,1) - 1).*(p(2).*s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(5).*s(:,1)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) + 1)./x(:,3); % d eq_22 w.r.t. k
      out2(:,22,2) = 0; % d eq_22 w.r.t. mm
      out2(:,22,3) = 0; % d eq_22 w.r.t. mL
      out2(:,22,4) = 0; % d eq_22 w.r.t. z
      out2(:,22,5) = p(15).*x(:,1)./x(:,3); % d eq_22 w.r.t. u
      out2(:,23,1) = 0; % d eq_23 w.r.t. k
      out2(:,23,2) = 0; % d eq_23 w.r.t. mm
      out2(:,23,3) = 0; % d eq_23 w.r.t. mL
      out2(:,23,4) = 0; % d eq_23 w.r.t. z
      out2(:,23,5) = 0; % d eq_23 w.r.t. u
      out2(:,24,1) = 0; % d eq_24 w.r.t. k
      out2(:,24,2) = 0; % d eq_24 w.r.t. mm
      out2(:,24,3) = 0; % d eq_24 w.r.t. mL
      out2(:,24,4) = 0; % d eq_24 w.r.t. z
      out2(:,24,5) = 0; % d eq_24 w.r.t. u
    % da/dx
          out3 = zeros(n,24,4);
      out3(:,1,1) = 0; % d eq_1 w.r.t. R
      out3(:,1,2) = 0; % d eq_1 w.r.t. PI
      out3(:,1,3) = 0; % d eq_1 w.r.t. RL
      out3(:,1,4) = (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))); % d eq_1 w.r.t. nu_def
      out3(:,2,1) = 0; % d eq_2 w.r.t. R
      out3(:,2,2) = 0; % d eq_2 w.r.t. PI
      out3(:,2,3) = 0; % d eq_2 w.r.t. RL
      out3(:,2,4) = (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))); % d eq_2 w.r.t. nu_def
      out3(:,3,1) = 0; % d eq_3 w.r.t. R
      out3(:,3,2) = 0; % d eq_3 w.r.t. PI
      out3(:,3,3) = 0; % d eq_3 w.r.t. RL
      out3(:,3,4) = s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*exp(s(:,4))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))); % d eq_3 w.r.t. nu_def
      out3(:,4,1) = 0; % d eq_4 w.r.t. R
      out3(:,4,2) = 0; % d eq_4 w.r.t. PI
      out3(:,4,3) = 0; % d eq_4 w.r.t. RL
      out3(:,4,4) = s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))); % d eq_4 w.r.t. nu_def
      out3(:,5,1) = 0; % d eq_5 w.r.t. R
      out3(:,5,2) = 0; % d eq_5 w.r.t. PI
      out3(:,5,3) = 0; % d eq_5 w.r.t. RL
      out3(:,5,4) = s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(-p(5) + 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1).^2) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1)); % d eq_5 w.r.t. nu_def
      out3(:,6,1) = 0; % d eq_6 w.r.t. R
      out3(:,6,2) = 0; % d eq_6 w.r.t. PI
      out3(:,6,3) = 0; % d eq_6 w.r.t. RL
      out3(:,6,4) = p(2).*s(:,1).^(p(2) - 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*exp(s(:,4))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))); % d eq_6 w.r.t. nu_def
      out3(:,7,1) = 0; % d eq_7 w.r.t. R
      out3(:,7,2) = 0; % d eq_7 w.r.t. PI
      out3(:,7,3) = 0; % d eq_7 w.r.t. RL
      out3(:,7,4) = 0; % d eq_7 w.r.t. nu_def
      out3(:,8,1) = 0; % d eq_8 w.r.t. R
      out3(:,8,2) = 0; % d eq_8 w.r.t. PI
      out3(:,8,3) = 0; % d eq_8 w.r.t. RL
      out3(:,8,4) = (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2); % d eq_8 w.r.t. nu_def
      out3(:,9,1) = 0; % d eq_9 w.r.t. R
      out3(:,9,2) = 0; % d eq_9 w.r.t. PI
      out3(:,9,3) = 0; % d eq_9 w.r.t. RL
      out3(:,9,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))); % d eq_9 w.r.t. nu_def
      out3(:,10,1) = (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(-(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(4) + s(:,5)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(p(4) + s(:,1) + s(:,5))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(x(:,3).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3)).^2); % d eq_10 w.r.t. R
      out3(:,10,2) = 0; % d eq_10 w.r.t. PI
      out3(:,10,3) = -(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1).*(-(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(4) + s(:,5)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(p(4) + s(:,1) + s(:,5))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(x(:,3).^2.*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3)).^2) + (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(p(4) + s(:,1) + s(:,5))./(x(:,3).^2.*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3))); % d eq_10 w.r.t. RL
      out3(:,10,4) = (-(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./(p(14).*x(:,3).*(1 + p(13).*(-p(12) + x(:,4))./p(14)))).*(-(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(4) + s(:,5)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(p(4) + s(:,1) + s(:,5))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3)).^2 + (s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(p(4) + s(:,5))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(p(4) + s(:,1) + s(:,5))./(p(14).*x(:,3).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(x(:,1) - 1)./x(:,3)); % d eq_10 w.r.t. nu_def
      out3(:,11,1) = 0; % d eq_11 w.r.t. R
      out3(:,11,2) = 0; % d eq_11 w.r.t. PI
      out3(:,11,3) = 0; % d eq_11 w.r.t. RL
      out3(:,11,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))); % d eq_11 w.r.t. nu_def
      out3(:,12,1) = 0; % d eq_12 w.r.t. R
      out3(:,12,2) = -s(:,2)./(x(:,2) + 1).^2; % d eq_12 w.r.t. PI
      out3(:,12,3) = 0; % d eq_12 w.r.t. RL
      out3(:,12,4) = 0; % d eq_12 w.r.t. nu_def
      out3(:,13,1) = 0; % d eq_13 w.r.t. R
      out3(:,13,2) = -s(:,3)./(x(:,2) + 1).^2; % d eq_13 w.r.t. PI
      out3(:,13,3) = 0; % d eq_13 w.r.t. RL
      out3(:,13,4) = -s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) - s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) - s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))); % d eq_13 w.r.t. nu_def
      out3(:,14,1) = 0; % d eq_14 w.r.t. R
      out3(:,14,2) = s(:,3)./((x(:,2) + 1).^2.*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_14 w.r.t. PI
      out3(:,14,3) = 0; % d eq_14 w.r.t. RL
      out3(:,14,4) = (s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2; % d eq_14 w.r.t. nu_def
      out3(:,15,1) = 0; % d eq_15 w.r.t. R
      out3(:,15,2) = s(:,3)./(x(:,2) + 1).^2; % d eq_15 w.r.t. PI
      out3(:,15,3) = 0; % d eq_15 w.r.t. RL
      out3(:,15,4) = s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))); % d eq_15 w.r.t. nu_def
      out3(:,16,1) = -1./(x(:,1).^2.*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))); % d eq_16 w.r.t. R
      out3(:,16,2) = s(:,3)./(x(:,1).*(x(:,2) + 1).^2.*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_16 w.r.t. PI
      out3(:,16,3) = 0; % d eq_16 w.r.t. RL
      out3(:,16,4) = (s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./(x(:,1).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,3)./(x(:,2) + 1) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)).^2); % d eq_16 w.r.t. nu_def
      out3(:,17,1) = (p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./x(:,3); % d eq_17 w.r.t. R
      out3(:,17,2) = 0; % d eq_17 w.r.t. PI
      out3(:,17,3) = -(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3).^2; % d eq_17 w.r.t. RL
      out3(:,17,4) = -(x(:,1) - 1).*(s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./x(:,3); % d eq_17 w.r.t. nu_def
      out3(:,18,1) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)); % d eq_18 w.r.t. R
      out3(:,18,2) = 0; % d eq_18 w.r.t. PI
      out3(:,18,3) = -p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./(x(:,3).^2.*(-p(2) + 1).*(p(5) - 1)); % d eq_18 w.r.t. RL
      out3(:,18,4) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-(x(:,1) - 1).*(s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./((-p(2) + 1).*(p(5) - 1)) - p(5).*s(:,1).^(-p(2)).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + (p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(-p(2) + 1).*(p(5) - 1).^2); % d eq_18 w.r.t. nu_def
      out3(:,19,1) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-p(15).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./x(:,3) + p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)); % d eq_19 w.r.t. R
      out3(:,19,2) = 0; % d eq_19 w.r.t. PI
      out3(:,19,3) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(15).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3).^2 - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)) - p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-p(15).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3) + x(:,3).*(p(4) + s(:,5)) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1) + (-x(:,1) + x(:,3)).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./(x(:,3).^2.*(-p(2) + 1).*(p(5) - 1)); % d eq_19 w.r.t. RL
      out3(:,19,4) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(p(15).*(x(:,1) - 1).*(s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./x(:,3) + (-x(:,1) + x(:,3)).*(s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14)))) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(-p(5) + 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1).^2) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1)))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)) - p(5).*s(:,1).^(-p(2)).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-p(15).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3) + x(:,3).*(p(4) + s(:,5)) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1) + (-x(:,1) + x(:,3)).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./(p(14).*x(:,3).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(-p(2) + 1).*(p(5) - 1).^2); % d eq_19 w.r.t. nu_def
      out3(:,20,1) = 0; % d eq_20 w.r.t. R
      out3(:,20,2) = 0; % d eq_20 w.r.t. PI
      out3(:,20,3) = -p(5).*s(:,1).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)) - p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(x(:,3).^2.*(-p(2) + 1).*(p(5) - 1)); % d eq_20 w.r.t. RL
      out3(:,20,4) = p(5).*s(:,1).^(-p(2)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(-p(5) + 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1).^2) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(p(5) - 1)))./(x(:,3).*(-p(2) + 1).*(p(5) - 1)) - p(5).*s(:,1).^(-p(2)).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(-1./(p(5) - 1)).*(-x(:,3).*s(:,1) + s(:,1).^p(2).*(p(5)./(p(5) - 1)).^(-p(5)).*((1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(p(5) - 1)./p(5)).^(-p(5) + 1).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(p(2) + p(5)./(p(5) - 1) - 1).*exp(s(:,4))./(p(5) - 1))./(p(14).*x(:,3).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(-p(2) + 1).*(p(5) - 1).^2); % d eq_20 w.r.t. nu_def
      out3(:,21,1) = p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5); % d eq_21 w.r.t. R
      out3(:,21,2) = 0; % d eq_21 w.r.t. PI
      out3(:,21,3) = s(:,1) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5); % d eq_21 w.r.t. RL
      out3(:,21,4) = (-x(:,1) + x(:,3)).*(s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14)))); % d eq_21 w.r.t. nu_def
      out3(:,22,1) = p(15).*(p(4) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) + s(:,5) - s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5))./x(:,3); % d eq_22 w.r.t. R
      out3(:,22,2) = 0; % d eq_22 w.r.t. PI
      out3(:,22,3) = -p(15).*(p(4) + s(:,1) + s(:,5) - (x(:,1) - 1).*(-p(4) - s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)) - s(:,5) + s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./p(5)))./x(:,3).^2; % d eq_22 w.r.t. RL
      out3(:,22,4) = -p(15).*(x(:,1) - 1).*(s(:,1).^p(2).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(5) - 1).*((1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))) - x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-2./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^2))./p(5) + s(:,1).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(p(14).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)))).*(p(5) - 1)./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))) + s(:,1).^p(2).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13)).*(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))).^(1./(p(5) - 1)).*(-p(2) + 1).*(p(14) + x(:,4).*(1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))./(1 - (1 + p(13).*(-p(12) + x(:,4))./p(14)).^(-1./p(13))))./(p(14).*p(5).*(1 + p(13).*(-p(12) + x(:,4))./p(14))))./x(:,3); % d eq_22 w.r.t. nu_def
      out3(:,23,1) = 0; % d eq_23 w.r.t. R
      out3(:,23,2) = 0; % d eq_23 w.r.t. PI
      out3(:,23,3) = 0; % d eq_23 w.r.t. RL
      out3(:,23,4) = 0; % d eq_23 w.r.t. nu_def
      out3(:,24,1) = 0; % d eq_24 w.r.t. R
      out3(:,24,2) = 0; % d eq_24 w.r.t. PI
      out3(:,24,3) = 0; % d eq_24 w.r.t. RL
      out3(:,24,4) = 0; % d eq_24 w.r.t. nu_def
end
                    
end

function [out1] = model_info() % informations about the model

    mod = struct;
    mod.states = { 'k','mm','mL','z','u' };
    mod.controls = { 'R','PI','RL','nu_def' };
    mod.auxiliaries = { 'Phi','mu','w','y','pro','rk','x','Enu_def','d_per','d_imp','d','m','c','uc','I','lamb','lhat','nu_rat','nu_strat','nu_star','pro_B','pro_def','perfect','rat' };
    mod.parameters = { 'beta','alpha','delta','x_ss','theta','gamma','varphi','rho','sigma_z','sigma_u','spreadq','me','xi','sigma','vartheta','big' };
    mod.shocks = { 'e_z','e_u' };
    mod.s_ss = [25.1114 ; 2.42894429861 ; 2.39895733196 ; 0.0 ; 0.0];
    mod.x_ss = [1.02272727273 ; 0.0125 ; 1.02272727273 ; -14.4731];
    mod.params = [  9.90000000e-01   3.60000000e-01   1.90000000e-02   1.25000000e-02   6.00000000e+00   5.00000000e-01   0.00000000e+00   9.50000000e-01   7.00000000e-03   7.00000000e-03   9.50000000e-03  -3.00000000e+01   9.00000000e-01   2.00000000e-01   5.00000000e-01   5.00000000e+00];
    mod.X = cell(2,1);
    mod.X{1} = [  1.02272727e+00   1.25000000e-02   1.02272727e+00  -1.44731000e+01];
    mod.X{2} = [[-0.00044918  0.40905541 -0.4141686   0.0222216  -0.1901456  ; -0.01507889  0.40206725  0.01496527 -0.40645422  0.19802594 ; -0.00044918  0.40905541 -0.4141686   0.0222216  -0.1901456  ; -0.37721516 -0.12311653  0.12465549  0.30112984  0.05722957]];
    out1 = mod;

end
